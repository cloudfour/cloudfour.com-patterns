import { ArgsTable, Meta, Story } from '@storybook/addon-docs';
import { basename, extname } from 'path';
import hljs from 'highlight.js';
import sampleDemo from './demo/sample.twig';
// Load samples directory as "raw" text
const samplesDir = require.context('!!raw-loader!./demo/samples', false);
// Initialize an object to store sample content in
const samples = {};
// For each sample, fetch its content and build an object for our template
for (const key of samplesDir.keys()) {
  const filename = basename(key);
  const ext = extname(key);
  const name = filename.replace(ext, '');
  const content = samplesDir(key).default;
  const language = [name, ext.slice(1)].find(
    (val) => hljs.getLanguage(val) !== undefined
  );
  const html = language && hljs.highlight(content, { language }).value;
  samples[name] = { filename, name, ext, content, html };
}
const sampleStory = (args) => sampleDemo(samples[args.language || 'markup']);

<Meta
  title="Vendor/Highlight"
  argTypes={{
    language: {
      options: Object.keys(samples),
      type: 'string',
      control: {
        type: 'select',
      },
    },
  }}
/>

# Highlight

TODO!

<Story name="Example" args={{ language: 'markup' }}>
  {sampleStory.bind()}
</Story>

<ArgsTable story="Example" />
