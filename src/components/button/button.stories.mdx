import { Story, Canvas, Meta } from '@storybook/addon-docs/blocks';
import { useEffect } from '@storybook/client-api';
import stylesDemo from './demo/styles.twig';
import iconButtonCustomDemo from './demo/icon-button-custom-demo.twig';
import button from './button.twig';
import { initTogglingButton } from './toggling-button.ts';
const iconControlConfig = {
  type: { name: 'string' },
  control: {
    type: 'select',
    options: [
      '',
      'notifications',
      'search',
      'heart',
      'brands/github',
      'brands/twitter',
    ],
  },
  defaultValue: '',
};
// Helper function to initialize toggling button JS
const togglingButtonStory = (args) => {
  useEffect(() => {
    const { destroy } = initTogglingButton(
      document.querySelector('.js-c-button')
    );
    return destroy;
  }, []);
  if (args.isIconButtonCustomDemo) {
    return iconButtonCustomDemo(args);
  }
  return button(args);
};

<Meta
  title="Components/Button"
  argTypes={{
    href: { type: { name: 'string' } },
    type: {
      type: { name: 'enum' },
      control: { type: 'inline-radio', options: ['button', 'submit'] },
      defaultValue: 'button',
    },
    disabled: { type: { name: 'boolean' }, defaultValue: false },
    content_start_icon: iconControlConfig,
    content_end_icon: iconControlConfig,
    aria_pressed: {
      type: { name: 'enum' },
      control: { type: 'inline-radio', options: ['true', 'false'] },
    },
  }}
/>

# Button

The `c-button` class may be applied to button and link elements. The button appears filled by default so that the actionable element is clearly distinguished from surrounding text.

<Canvas>
  <Story name="Button Element" args={{ label: 'Button', href: false }}>
    {(args) => button(args)}
  </Story>
  <Story name="Link Element" args={{ label: 'Link', tagName: 'a' }}>
    {(args) => button(args)}
  </Story>
</Canvas>

## Styles

Some buttons may not require as much emphasis as others. The `c-button--secondary` and `c-button--tertiary` modifiers reflect lesser importance with reduced contrast.

<Canvas>
  <Story name="Styles">{(args) => stylesDemo(args)}</Story>
</Canvas>

All the above visual styles will appear slightly different within [our dark theme](/docs/design-themes--dark). These versions retain their visual emphasis relative to one another while remaining visually distinct from form inputs.

<Canvas>
  <Story name="Styles (Dark)" parameters={{ theme: 't-dark' }}>
    {(args) => stylesDemo(args)}
  </Story>
</Canvas>

## Button with icon

To add an icon, pass the name of any of the [available icons](/docs/design-icons--page)
to the `content_start_icon` or `content_end_icon` properties.

```twig
{% embed '@cloudfour/components/button/button.twig' with {
  label: 'Get notifications'
  content_start_icon: 'notifications'
} only %}
```

<Canvas>
  <Story
    name="Icon"
    args={{
      content_start_icon: 'notifications',
      label: 'Get notifications',
    }}
  >
    {(args) => button(args)}
  </Story>
</Canvas>

## Custom icon

If you need a custom icon, you can pass an `<svg>` element directly via the
`content_start` or `content_end` Button component block. This option is only
recommended in unique cases. Also note the usage of the `c-icon`
CSS classes on the `<svg>` element.

The `content_start`/`content_end` blocks override the
`content_start_icon`/`content_end_icon` values.

```twig
{% embed '@cloudfour/components/button/button.twig' %}
  {% block content %}Button with a custom icon{% endblock %}
  {% block content_end %}
    <svg viewBox="0 0 24 24" width="24" height="24" class="c-icon c-icon--inline">
      <circle r="8" cx="12" cy="12"></circle>
    </svg>
  {% endblock %}
{% endembed %}
```

<Canvas>
  <Story name="Custom Icon">{(args) => iconButtonCustomDemo(args)}</Story>
</Canvas>

## Toggling button

Pass an `aria_pressed` value (`'true'` or `'false'`) to enable a toggling button. If no `content_start_icon`/`content_end_icon` or `content_start`/`content_end` block content is passed in, the `'notifications'` icon will be used by default as the `content_start_icon` value.

You can override the `content_start_icon` value to a different icon.

<Canvas>
  <Story
    name="Toggling Button"
    args={{
      aria_pressed: 'true',
    }}
  >
    {(args) => togglingButtonStory(args)}
  </Story>
  <Story
    name="Secondary Toggling Button"
    args={{
      class: 'c-button--secondary',
      aria_pressed: 'true',
    }}
  >
    {(args) => togglingButtonStory(args)}
  </Story>
  <Story
    name="Tertiary Toggling Button"
    args={{
      class: 'c-button--tertiary',
      aria_pressed: 'true',
    }}
  >
    {(args) => togglingButtonStory(args)}
  </Story>
  <Story
    name="Custom Icon Toggling Button"
    args={{ aria_pressed: 'true', isIconButtonCustomDemo: true }}
  >
    {(args) => togglingButtonStory(args)}
  </Story>
</Canvas>

## Template Properties

- `aria_expanded` (string, `'true'`/`'false'`): Sets the button's `aria-expanded` attribute.
- `aria_pressed` (string, `'true'`/`'false'`): Sets the button's `aria-pressed` attribute.
- `class` (string): Append a class to the root element.
- `content_start_icon` (string): The name of the [icon](/docs/design-icons--page) to render in the `content_start` block.
- `content_end_icon` (string): The name of the [icon](/docs/design-icons--page) to render in the `content_end` block.
- `disabled` (boolean): Sets the button's `disabled` attribute.
- `href` (string): Converts the button to an anchor element and assigns the `href` value. Defaults to `#` if `a` is passed as the `tag_name`.
- `label` (string, default `'Hello world'`): Sets the button's text content.
- `tag_name` (string, default `'button'`): The tag for the button. Uses a `button` by default, an `a` when an `href` value is passed.
- `type` (string, default `'button'`): Sets the button's `type` value.

## Template Blocks

- `content_start`: Block to add content before the Button `content` block.
- `content`: Block to add Button elements.
- `content_end`: Block to add content after the Button `content` block.

## See Also

See the [Button Group object](/docs/objects-button-group--default-story) to align a group of related Button components.
